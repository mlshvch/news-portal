# README

## Описание

Система позволяет пользователям просматривать новостные материалы в соответствии с правами доступа.

Пользователи:

- админ
- редактор
- корреспондент
- зарегистрированный пользователь
- незарегистрированный пользователь

Новости разделены по категориям.

Блоки (или можно назвать - ленты) новостей:

- важные новости
- список новостей (по категориям)
- самое читаемое
- последние обновления

На странице просмотра новости текст новости отображается в соответствии с правами доступа пользователя.

Так же при просмотре доступны переходы на списки «связанные материалы» и «ещё по теме» (материалы, связанные по ключевым
словам, регионам, категориям, тегам и т.п.)

Новости пишут только корреспонденты.

Новость публикуется (становится видимой для всех) только после аппрува редактора.

Основные составляющие новости:

- заголовок
- краткое описание
- полный текст
- маска доступа (новость видна всем, видны заголовок и аннотация, виден только заголовок, скрыта от незарегистрированных
  пользователей)
- главное изображение (для отображения в списках)
- набор прочих изображений (для отображения в полном тексте новости)
- дата добавления (заполняется автоматически)
- дата отображения на сайте (выставляется вручную)
- статус (неактивна, активна, опубликована, архив; по умолчанию - неактивна)
- флаг “важная” (по умолчанию - “нет”)
- рейтинг (выставляется любыми зарегистрированными пользователями)

Неавторизованные пользователи могут просматривать новость в соответствии с её маской доступа только в ограниченном
объёме (кроме “видна всем”).

Любые зарегистрированные пользователи могут оставлять комментарии к новости.

Можно экспортировать новости в RSS.

Автоматически забирать новости из сторонних RSS.

По каждой новости собирается статистика просмотров.

## Инструкция

1. ...
2. ...
3. ...

## Требования

### Общие требования

- Должна быть реализована регистрация с подтверждением по email (А так же регистрация через сторонние сервисы – google,
  github, linkedIn - один на выбор).
- Минимум две роли: admin и user. Admin может все: видеть, создавать, удалять, редактировать все сущности. Пользователь
  – только свои.
- Любой пользователь может оставлять комментарии к одной из public сущностей (указано в проекте). Также можно оставлять
  комментарии на комментарии.
- Реализовать поиск(ElasticSearch пока не надо, а через СУБД) в шапке сайта, который ведет на страницу поиска.
- Пользователь может редактировать свой профиль – аватар, имя, фамилия, никнейм который будет отображаться для других
  пользователей (если указан), дата рождения, адрес.
- На главной странице можно выбрать один из 2 языков сайта.
- Достаточно сделать интернационализацию только для главной страницы.
- Для остальных страниц не обязательно.
- Добавить функционал экспорта какой-либо одной сущности в CSV. По нажатию на кнопку скачивания необходимо дать
  пользователю возможность скачать отчет.
- В проекте должны присутсвовать Background Jobs, и так же вызов background jobs по расписанию(aka cron jobs)
- Добавить админку
- Заполнить базу необходимыми статическими данными через seeds файл (если необходимо), и генерирующимися тестовыми
  данными через rake task.

### Технологии

- Ruby on Rails
- Предполагается подход REST
- Pundit для авторизации
- Devise для аутентификации
- ORM ActiveRecord и Postgres как реляционная СУБД
- Sidekiq для background jobs
- Гем Simple Form для форм
- Bootstrap для верстки

### Стандарт кодирования

Поставить Rubocop(пару плагинов, если понадобятся) и настроить его для проекта.

Можно сразу использовать open-source настройки, такие как Ruby Community Styleguide, Airbnb

Правила должны игнорироваться по мере необходимости(добавляются в rubocop_todo.yml или комментарием). В любом случае
Rubocop должен проходить успешно, без offenses.

Необходимо помнить, что rubocop - всего лишь рекомендации по стандарту. Полное следование всем правилам может отнять
достаточно времени(Metrics/AbcSize и др.). Поэтому некоторые правила можно отключить в угоду остальным задачам.

### Безопасность

Не приветствуются:

- N+1 запросы(гем Bullet поможет)
- SQL-инъекции
- Уязвимость к CSRF
- Уязвимость к XSS

### Паттерны

Необходимо реализовать(минимум по одной реализации каждого) следующие паттерны:

- Form Object
- Query Object (внутри сырой SQL)
- Presenter или Decorator
- Service

### Тестирование

С помощью фреймворка RSpec написать тесты на критически важный функционал. Скоуп тестов необходимо уточнить у ментора.

Обязательно должны присутствовать виды тестов

1. Controller
2. Model
3. Request spec
4. Feature spec (подключая Capybara)
5. Service, или же тесты на PORO (Plain old Ruby objects), играющие значимую роль в приложении Для того, чтобы ментору
   было удобно увидеть процент и качество покрытия, использовать гем simplecov

Опционально, если имеется на это время - сделать покрытие, близкое к 100%.

### Работа с GitHub

Разрабатывать функционал отдельными фичами

Работать над каждой фичей в отдельном бранче

Делать атомарные коммиты с полным и понятным описанием изменений в данном коммите.

Каждый pull request должен быть одобрен ментором, который можно мержить в основной master бранч только после аппрува.

### Ретроспектива

В README файле проекта нужно отразить:

- Самое сложное задание
- Самое интересное задание
- Что можно было бы сделать, если бы было больше времени
- Инструкция о том, как с нуля развернуть проект(зависимости) и команды запуска

### Task tracking

Создать таски в Trello или GitHub Actions и отображать их прогресс (Backlog, InProgress, Done). Описания вести на
английском языке

### Deploy

В качестве рекомендуется использовать сервис Heroku (free tiers) - простой и удобный сервис для деплоя. 


